2단계 로또(자동)
===

## 기능 요구 사항
* 로또 구입 금액을 입력하면, 구입 금액에 해당하는 로또를 발급해야 한다.
* 로또 1장의 가격은 1000원 이다.

## 구현 요구 사항
* 모든 기능을 TDD로 구현하며, pulbic으로 접근 가능한 메서드에 대해 단위 테스트를 작성 한다.
* 핵심 로직과 UI를 담당하는 로직을 분리한다.
* 들여쓰기는 2 depth를 넘지 않도록 구현한다.
* 함수의 길이가 15라인을 넘어가지 않도록 구현한다.
* 구현할 기능 목록을 README.md에 작성한 후, 기능 목록 단위로 commit한다.

## 구현 기능 목록
* 로또 로직 구현
* Controller
  * [x] 사용자로부터 `구매 금액`을 입력 받아 `금액만큼 로또를 발급`한다.
  * [x] 발급된 로또 정보를 출력부에 전달한다.
  * [x] 사용자로부터 `당첨 번호`를 입력 받는다.
  * [x] 로또 프로그램 실행에 필요한 구매 금액과, 구매 금액만큼 생성된 로또, 당첨 번호 객체를 `로또 로직 실행부에 전달`한다. 
    * [x] 구매 정보(PurchaseItem) : 구매 금액과, 금액만큼 발행된 로또를 표현 
  * [x] 사용자로부터 `금액`과 `당첨 번호`를 입력받아 `로또 로직 실행부에 전달`한다.
  * [x] `로또 로직 실행 결과`를 반환 받아 `출력부에 전달`한다.

* Service
  * [x] 컨트롤러로 부터 넘겨받은 실행 정보를 이용하여 `로또를 발급`하고 `당첨 번호와 비교한 결과를 반환`한다.
    * [x] `난수 생성기`를 이용하여 로또 한게임에 필요한 `6개의 로또 번호 난수를 생성`한다.  
  * [x] `발급된 전체 로또`와 `당첨 번호`를 `판별부에 전달`하여 그 `당첨 결과를 반환` 컨트롤러에 반환한다.
  * [x] LottoGenerator(Interface) : 난수 로또 생성기
    * [x] RandomNumberGenerator : `프로그램 실행 환경`에서 필요한 `난수 로또를 생성`한다.
    * [x] TestNumberGenerator : `테스트 실행 환경`에서 필요한 `정의된 수의 로또를 생성`한다.

* Domain
  * [x] 로또 번호(LottoNumber, 원시 타입 포장 객체) : 1~45 범위의 로또 번호를 표현
    * [x] `프로그램 시작 시`, 1부터 45까지의 값을 가지는 `LottoNumber 객체를 생성 후 Map에 저장`하여, `LottoNumber 객체 생성 요청 마다 객체를 생성하지 않고 Map에 저장된 동일 객체를 반환`한다.

  * [x] 로또(Lotto, 일급 컬렉션) : 6개의 로또 번호로 구성된 `로또 한게임을 표현`한다.
    * [x] LottoNumber 객체의 숫자가 같은 경우 동일한 객체이므로, `중복 없는 난수`를 저장하기 위해 6개의 로또 번호는 `Set<LottoNumber>`의 자료형으로 표현한다.
    * [x] 당첨 번호와 비교하여 당첨 결과를 반환한다.
      * [x] 당첨 번호와 비교하여 일치하는 숫자 개수를 판별한다.
        * [x] LottoNumber 객체의 숫자가 같은 경우 동일한 객체이므로, `Set.intersect() 함수를 이용`하여 `당첨 번호 원소와의 교집합 원소의 개수`로 판별한다.
      * [x] 일치하는 숫자 개수를 통해 당첨 결과 객체를 생성한다.
        * [x] 당첨 결과(MatchResult) : `일치된 개수를 이용`하여 1~6등의 `당첨 등수를 반환`한다.

  * [x] 로또 목록(Lottos) : `여러 게임`의 `로또를 표현`한다.
    * [x] `각 로또`에 `당첨 번호를 전달`하고 반환된 `당첨 결과 객체를 합산`하여 전체 당첨 결과를 반환한다.
      * [x] 각 로또의 당첨 결과 합산 시, 각 등수 당첨 수를 누적한다. 
      * [x] 당첨 결과 목록(PlayResults) : `전체 로또`의 `합산된 당첨 결과`와 `각 등수의 당첨 수`를 표현 하고, 통계 정보를 산출한다.
        * [x] 등수별 당첨 수, 수익률(당첨 금액/구매 금액)

  * [x] 당첨 번호(WinningNumber, 일급컬렉션) : 6개의 로또 번호로 구성된 `당첨 번호를 표현`한다.
    * 당첨 번호 유효성 검증
      * [x] `빈값`, `공백`이 포함된 경우
      * [x] `숫자가 아닌 값`이 포함된경우
      * [x] `1~45 범위를 벗어나는 숫자`가 포함된 경우
      * [x] 입력된 숫자가 `중복 없는 6개의 숫자`가 아닌 경우

  * [x] 구입 금액(BuyAmount) : 사용자로부터 입력된 로또 구입 금액
    * [x] 구입 금액 유효성 검증
      * [x] `빈값` 또는 `공백`을 입력하는 경우
      * [x] `숫자가 아닌 값`을 입력하는 경우
      * [x] `1000원 미만`이거나 `1000원 단위가 아닌 경우`

* View
  * Input
    * [x] 구입 금액 입력 부 구현
    * [x] 당첨 번호 입력 부 구현
    * [x] 유효하지 않은 입력 값인 경우 `재 입력` 처리 
  * OutPut
    * [x] `구입 금액` 및 구입 금액 만큼 `발급한 로또 수 및 각 로또 번호` 출력 
    * [x] `당첨 결과 객체`를 통해 `당첨 통계 출력` 부 구현
  
---
## 잘못 구현된 로직 수정
* [x] 지난주 당첨 번호 입력 방식 오류
  * AS-IS : readln()을 통해 6개의 당첨 번호를 한라인에 하나씩 입력
  * TO-BE : readln()을 이용해 한라인에 ,를 구분자로 입력된 6개의 당첨 번호를 입력
* [x] 45번에 해당하는 LottoNumber 객체 생성 시 NuSuchElementException 예외 발생 오류
  * AS-IS : 1부터 45까지 LottoNumber 객체를 생성하기 위해 repeat()함수 조건에 45를 명시하여, 0을 Index로 시작하여 44까지의 LottoNumber 객체가 생성되어 캐싱된 Map에 숫자 45에 해당하는 LottoNumber 객체가 존재하지 않아 예외 발생 
  * TO-BE : 0부터 44까지 반복하여 LottoNumber 객체를 생성하는 조건을 1부터 45까지 반복하여 LottoNumber 객체를 생성 후 Map에 캐싱하도록 수정
* [x] 난수 생성기의 중복된 난수 발생으로 인한 로또 객체 생성 오류 발생
  * AS-IS : 로또 객체 생성에 필요한 6개의 난수 발생 시, 난수 생성기의 중복된 난수 발생으로 인해 6개보다 적은 로또 번호 객체가 생성되어 유효성 검증 오류 발생 
  * TO-BE : Lotto 객체 생성 인자를 List<Int>에서 Set<Int>로 변경하여 중복 없는 6개의 난수를 입력 받도록 수정
* [x] 로또 당첨 결과 출력 내용 오류 
  * 정렬되지 않은 로또 출력 오류
    * AS-IS : Set 자료형에 발생한 난수 순으로 저장된 로또를 출력
    * TO-BE : 발급된 각 로또 출력 시 정렬 처리를 위해 Comparable.compareTo 구현하여, 정렬된 로또를 반환 받아 출력
  * 로또 당첨 결과 출력 시, 객체의 메모리값 출력 오류 
    * AS-IS : 출력 대상 객체의 toString() 미 구현
    * TO-BE : 출력 대상 객체에 toString() 구현
* [x] 잘못 구현된 로또 프로그램 진행 오류
  * AS-IS : 지난주 로또 번호 입력이 구매 금액만큼 로또를 발급하는 로직보다 먼저 실행
  * TO-BE : LottoController 에서 로또 프로그램 실행에 필요한 객체 생성을 완료한 후, 생성된 객체를 비지니스 로직부에 전달
    * 사용자로부터 `구매 금액`을 입력 받아 `금액만큼 로또를 발급`한다.
    * 발급된 로또 정보를 출렵구에 전달한다.
    * 사용자로부터 `당첨 번호`를 입력 받는다.
    * 로또 프로그램 실행에 필요한 구매 금액과, 구매 금액만큼 생성된 로또, 당첨 번호 객체를 `로또 로직 실행부에 전달`한다.
      * 구매 정보(PurchaseItem) : 구매 금액과, 금액만큼 발행된 로또를 표현
    * 사용자로부터 `금액`과 `당첨 번호`를 입력받아 `로또 로직 실행부에 전달`한다.
    * `로또 로직 실행 결과`를 반환 받아 `출력부에 전달`한다.

---
# 코드 리뷰 피드백 내용 정리
- [x] package 구조 변경
  - AS-IS : step2.lotto
  - TO-BE : lotto
- [x] Lotto : 출력부를 위해 구현한 Lotto 객체의 원소를 정렬하는 함수를 제거하고, 팩토리 메서드에서 정렬된 원소를 가지는 Lotto 객체를 생성하도록 수정
- [x] InputView : readLine()!!을 이용한 값 입력 대신 readln()을 이용한 null safe한 값 입력 처리
- [x] RandomLottoGenerator : while 문을 이용한 중복없는 난수 생성부 개선
  - 1~45의 값을 가지는 List를 초기화 한 후, shuffled()와 subList()를 이용하여 중복없는 6개의 난수를 생성

### 가변 타입, var 사용 최소화
* [x] LottoNumber : 선언과 동시에 초기화 하여 LottoNumber 객체를 추가하기 위해 사용된 가변타입 MutableMap의 사용 개선
  * associateWith()를 이용한 선언과 동시에 초기화
  * mapIndex()를 이용한 선언과 동시에 초기화
* [x] RandomLottoGenerator, TestLottoGenerator : 구매 금액만큼 발급된 로또를 추가하기 위해 사용된 MutableMap을 선언과 동시에 초기화 하여 가변타입 사용 개선
  * List 생성자를 이용한 선언과 동시에 초기화 
* [x] PlayResults : 
  * var로 선언된 MutableList의 변수형 var에서 val로 변경
  * 외부 사용처가 없는 private 접근 제한자 추가 

### 관리 포인트 최소화
* [x] MatchResult : 일치하는 숫자 개수에 따른 당첨 등수 판별 부 수정
  * MatchResult enum의 각 원소의 일치하는 숫자 개수 속성을 이용하지 않고, 일치하는 숫자 개수를 입력 받아 당첨 등수를 반환하는 함수로 인해, 요구사항 변경 시 변경되어야 하는 관리포인트가 증가하는 문제를 각 원소의 일치하는 숫자 개수 속성을 이용하여 당첨 등수를 판단하도록 개선

* [x] PlayResult, ResultView : 등수별 당첨 수를 각 변수에 담고 있어 요구사항 변경 시 변수가 추가/제거 되는 현상 개선
  * AS-IS : 등수별 당첨 수에 해당하는 각 변수를 선언하고, 당첨 결과가 추가 될 때마다, 해당하는 변수에 값을 1 증가
  * TO-BE : 당첨 결과 목록을 받아 Map<MatchResult, Int> 형태로 당첨 결과 enum의 각 타입을 Key로 하여
    * `backing property`를 활용하여 내부에서만 가변 객체에 값을 변경하고, 외부 요청 시 불변 객체를 반환 하도록 설정 
    * `-`연산자를 이용하여 MatchResult.NOT_WINNING 항목의 집계 항목에서 제외 처리
    * get()를 operator로 정의하여 내부 값 접근 시 가독성 개선
